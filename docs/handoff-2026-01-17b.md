# Handoff - 2026-01-17b

## Context
Goal: stabilize local dev + testing loop and unblock automated verification for the upcoming Ralph loops / verifier lane work.

## Whatâ€™s done
- Dev setup and NATS startup now self-healing when `api/.env` is missing.
- Automated test runner preflight stops conflicting NATS containers on port 4222, then reboots NATS.
- Added setup script to create `api/.env` stub and install Python + Node deps.
- Core supervisor fixes landed earlier (per-connection harness, NATS rebuild materialization, CORS tightening, websocket limits, tool path guard, .choirignore matching).

## Files changed (this batch)
- `dev.sh` (auto-create api/.env stub)
- `scripts/setup.sh` (new)
- `scripts/test.sh` (preflight stop + reboot for NATS)
- `docs/00_INDEX.md`

## Tests run
- `./scripts/setup.sh`
- `./scripts/test.sh`
  - NATS container rebooted cleanly (port 4222 preflight)
  - Playwright E2E: 1 passed

## Known issues / gaps
- No Python unit/integration tests yet (only Playwright E2E).
- Verifier lane not implemented in Ralph loop yet.
- API artifact store still in-memory; no persistence.

## Recommended next steps
1) Implement verifier lane in Ralph loop to run `scripts/test.sh` and emit receipts.
2) Add Python unit tests for supervisor/db/event_contract to give verifier fast checks.
3) Wire verify profile selection (fast vs full) for agent loop.
4) Decide whether to add NATS preflight into dev.sh as well (optional).

## Notes
- `api/.env` is gitignored; scripts now create a stub to avoid docker compose failures.
- `scripts/test.sh` will fail if port 4222 is still held by a non-docker process.
